## Distributed file system
- File system: abstraction of thiết bị lưu trữ
- DFS:  Là hệ thống tệp tin cho phép truy cập trên môi
trường phân tán
- Lợi ích
	+ Chia sẻ tệp tin
	+ Cung cấp góc nhìn hợp nhất của hệ thống cho các ứng dụng khách (clients) khác nhau
	+ Quản lý tập chung
- Mục tiêu: Network (access) Transparency
	+ Truy cập ”trong suốt”
		• Người cung có thể truy cập tới tệp tin qua mạng dễ dàng như
		các tệp tin này được lưu trữ cục bộ
		• Người dùng không nhất thiết cần biết vị trí vật lý của tệp tin để
		truy cập tới tệp tin đó
	+ Tính “trong suốt” có thể được đảm bảo thông qua kỹ
	thuật định danh và “mount”
		• Location Transparency: Tên tệp không chứa thông tin về vị tr í
		vật lý của tệp tin
		• Location Independence: Tệp tin có thể được di rời qua vị trí
		vật lý mới mà không phải thay đổi tham chiếu tới nó (Tên tệp
		độc lập với vị trí lưu trữ vật lý của tệp)
		• Location independence → location transparency, nhưng
		ngược lại không được đảm bảo
- Mục tiêu: Tính sẵn sàng (Availability)
	+ Tính sẵn sàng: Tệp tin cần luôn luôn được truy
	cập dễ dàng và nhanh chóng
	+ Số lượng người dùng, hỏng hóc hệ thống, hay
	các hệ quả của sự phân tán cần không ảnh
	hưởng tiêu cực tới tính sẵn sàng
	+ Thường được giải quyết thông qua cơ chế
	nhân bản
- Các kiến trúc chung: 
	+ Chủ khách /Client-Server
		• Một hay nhiều máy chủ tham gia quản lý hệ thống tệp
		• Các tệp được lưu trữ trên thiết bị lưu trữ của máy chủ
		• Các thao tác tới tệp được gửi từ máy khách tới máy chủ
		• Ví dụ: Sun Microsystem Network File System (NFS),
		Google File System (GFS)
	+ Đối xứng / Symmetric
		• Phân tán hoàn toàn, dựa trên công nghệ mạng ngang
		hàng
		• Kiến trúc chủ – khách tập trung hoá sự lưu trữ và quản
		lý, kiến trúc ngang hàng phân tán hoá
		• Ví dụ Ivy (sử dụng Chord DHT)

## Các vấn đề về thiết kế trong hệ thống tệp tin phân tán
- Định danh và phân giải tên (định danh)
	Có 3 hướng
	+ nối hostname với tên file trên host -> thiếu tính Location Transparency
	+ mount remote dir onto local dir (Vd: NFS). Cách hoạt động: Bạn mount thư mục /shared của server vào thư mục /mnt/data của máy mình.Đánh giá: Tốt hơn cách 1, nhưng cấu hình giữa các máy có thể khác nhau (máy A mount vào /mnt, máy B mount vào /data), dẫn đến việc khó quản lý tên file nhất quán trên toàn hệ thống.
	+ Cung cấp 1 cấu trúc cây thư mục toàn cục duy nhất (VD: HDFS). Ví dụ: Dù file của bạn được chia nhỏ và nằm trên 100 DataNodes khác nhau, bạn vẫn chỉ truy cập nó qua một đường dẫn duy nhất: hdfs://namenode:port/user/data/file.csv. Đánh giá: Đạt được tính Location Transparency tuyệt đối. Người dùng và ứng dụng không cần quan tâm (và thực tế là không biết) file đang nằm ở node vật lý nào.
- Lựa chọn mô hình semantic khi có sự tương tranh
	+ UNIX semantics: Giá trị đọc được là giá trị thuộc về thao tác ghi cuối cùng 
	+ Session semantics: (k hiểu lắm) Thao tác ghi tới một tệp đang mở không cần phải được thấy ngay lập tức bởi các thao tác của người khác đã mở tệp đó. **KHI TỆP ĐÓNG LẠI** thì các thay đổi mới cần phải được thấy bởi các phiên mở tệp tiếp theo. 
	+ Immutable-Shared-Files semantics: Tệp không sửa và cập nhật được. Dễ thực hiện theo cơ chế này vì đơn giản. 
	+ Transactions: **all-or-nothing**
- Kỹ thuật vùng đệm: 
	* Các phương pháp cache: 
		+ Server caching: in main memory: vấn đề ram máy chủ có giới hạn, phải cân đối giữa dung lượng đệm và tài nguyên cho các tiến trình hệ thống, Dữ liệu vẫn phải đi qua mạng. 
		+ Client caching in main memory: Tốc độ cực nhanh, tuy nhiên dung lượng đệm của khách nhỏ, bị mất sạch khi client khởi động lại
		+ Client-cache trên ổ cứng: phù hợp cho large files, cho phép xử lý các tệp lớn và duy trì truy xuất dữ liệu ngay cả khi mất kết nối tới máy chủ.
	* Tradeoff: 
		+ Việc sử dụng bộ nhớ đệm giúp giảm tải cho máy chủ, tối ưu hóa băng thông mạng và hiệu suất đọc ghi ổ đĩa nhờ ưu tiên chuyển đổi các gói dữ liệu lớn, tuy nhiên sự đánh đổi lớn nhất nằm ở vấn đề nhất quán dữ liệu khi **chi phí để đồng bộ hóa các thao tác ghi giữa nhiều bộ đệm** là rất cao.
- Kỹ thuật nhân bản: 
	+ Việc nhân bản tệp dữ liệu lên nhiều máy chủ giúp tăng độ tin cậy, tính sẵn sàng và khả năng cân bằng tải, nhưng đồng thời đặt ra những thách thức lớn về việc duy trì sự trong suốt đối với người dùng cũng như đảm bảo tính nhất quán dữ liệu khi đối mặt với các sự cố hỏng hóc máy chủ hoặc phân tách mạng.